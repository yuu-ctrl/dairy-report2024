## 取り組んだ課題一覧
- Web技術入門　p137〜167まで　２周目
## わかったこと
- １、RDBMS
- 複数のテーブルを管理し、それらを組み合わせることで、目的に合った情報を抽出することが効率的にできる。またこのような作業は簡単な操作で実現できる。
- SQLによってDBにほしい情報を伝えることができる。SQLは何を、どこから、どのように抽出するかに特化。
- 「何を」どんな情報が欲しいかを定義(SELECT)
- 「どこから」どのテーブルから情報を取るか（FROM,INNER JOIN）
- 「どのように」（ON以降）
- 条件を定義することで欲しい情報が手に入る（指定しなかったら全てのパターンが抽出されてしまう）
- ２、WEbアプリでは、誰がどのようにSQLをDBへ渡すのか？
- WebアプリではapプログラムがSQLを発行し、クエリ結果をもらっている。
- ピザ・ペントミノの商品一覧画面を例に挙げると、このページはHTMLに直接記述していた。しかし新商品追加のたびにプログラムとHTMLどちらも修正しなければならないという問題が生まれる。そこでDBのみにリストを記録し、そのDBからリストを取得するように変えれば、DBのみの変更で修正可能になる。
- ３、DBサーバ分離
- メリットは主に3つある。1つ目は、集中的なアクセスに備えることができること。つまりCPを2つ使い、各CPで異なるプロセスを動作させることで、CPUの負担を分散させ、サーバのダウンを防ぐことができる。2つ目は、容量を確保できること。3つ目は、あらゆるWebシステムと統合し、新システムを作ることができる。
- ４、WebアプリとDBの通信
- 異なるSW同士における情報のやり取りには通信が必要。ブラウザとサーバはHTTPを使って通信。SQLの発行と結果の取得に関しては、DBとWebapが通信している。ただし、HTTPのように標準化されておらず、DB製品固有のプロトコルを使って、やりとりが行われている。
- ５、ServletとJSPを動かすためのAPサーバー
- JavaVM上ではAPサーバーとServletとJSPが内蔵されている。APがSとJを動かしている。
- CGIはリクエストが届くたびに起動しては捨てる使い捨てモデル、APサーバーはプロセスが常に実行されており、リクエストを受けてサーブレットやJSPを実行する使い回しモデルと言う点が違う
- ６、WebサーバとAPサーバの連携
- WebサーバとAPサーバは異なるSWなので、通信が必要。一般的には、APサーバがWebサーバ毎に連携用のモジュールを用意し、組み込むことで連携できるようになる。
- Tomcatとは、Apサーバのことである。
- Tomcatの場合は、Appachi（Webサーバ）向けにmod_jkという連携モジュールを提供し、連携を実現。
- mod_jkとTomcatの間の通信はajp13というプロトコルが使用されている。通信の高速化が狙い。
- ７、WebサーバーとApサーバの分担
- 静的コンテンツのみで構成されているページに関してはWebサーバに、動的コンテンツの場合はWebApに処理させる。このようにサーバサイドでは2つのプロセスが連携。Webサーバが全てのリクエストを一旦受け付けて、URLによってApサーバに飛ばすかどうかを判断。
- 転送すべきURLの判断軸はこちらから指定しなければならない。
- 転送対象のパスを指定し、その文字列に合致するURLのリクエストのみApサーバであるTomcatに転送する仕組みを作ることができる。例　JKMount /webtext/pentomino/*（転送対象のパス）　　worker1（転送対象のTomcatワーカー名）
- 指定されたパスにマッチしないURLのリクエストはWebサーバであるWebサーバであるApachiへのリクエストとして処理される。
- 要は、Webサーバがリクエストの窓口になっており、リクエストのパスによってはApサーバに処理をお願いするというもの。
- TCP/IPとはプロトコルの一つで、IPアドレスさえわかれば宛先のホストコンピュータを特定し、そのホストへ情報を届けることができるもの。実際には、TCP/IPはブラウザから受け取ったリクエストなどの情報をパケットと呼ばれる単位で細かく分割し、インターネットを通じて送信する。情報が送信された後、その情報は受け取る側のTCP/IPで元の形に組み立てられ、情報の受け手であるWebサーバなどのApに渡され、処理される。
- ajp13もTCP/IP上に成り立っているので、異なるノード間でも通信することができる。つまりWebサーバーとApサーバを分離しても、異なるノードでそれぞれ動かすことができる。Tomcatが動作する別のノードのIPアドレスさえわかれば、worker.worker1.host=の後にIPアドレスを記述すれば、変更が完了する。
- ８、ノードを分けるメリット
- 異なる性格のリクエストをうまく分担することができる。　あるページを表示するのに大量のHTTPリクエストを処理しなければならないWebページなどの静的コンテンツに関するリクエストはWebサーバにお願いし、数は少ないが重い処理である動的コンテンツはApサーバにお願いする。
- 必要であれば、複数のノードでTomcatをそれぞれ用意し、リクエストを転送することも可能。それぞれ別のパスを指定し、それぞれのTomcatでリクエストを処理させることができる。
- このように分離させておけば柔軟な構成が可能。しかしほとんどのApサーバはWebサーバの機能も内蔵されている。Tomcatもその一つ。実際に規模の小さいWebシステムや開発環境では採用されている。ただし、Apacheしかないの機能を使いたい場合は、分離し、連携させてから運用するのが現実的。
- ９、Webシステムの三層構成
- APサーバ、Webサーバ、DBサーバの3つを実際のノードにどのように配置するかによってwebシステムの構造が変わる。
- 最小構成のWebシステム
- サーバサイドがApサーバとDBサーバのみで構成されており、ApサーバがWebサーバとしての役割も担っている。最近の高性能なCPだからこそ1つのノードで実現できる。ちなみにApacheなどのWebサーバを利用することもできる。
- 一般的な構成
- １、利用者の多い大規模なWebシステム向けで採用されているシステム構造。ショッピングサイトなど。
- 全てのサーバーを別のノードで動作させる。それにより、各CPのリソースをフルで活用することができる。ここでいうリソースとは、CPU、メモリ、ハードディスクのことを指す。
- ２、利用者が少ないが、扱うデータ量が多い場合の構成
- DBサーバのみ分離。企業内の一部の人だけが利用するが、企業全体に関わる大量のデータを扱う必要のあるシステムのために採用されていることが多い。要は、DBサーバにリソースを多く割くパターン。
## 次やること
### 最低ノルマ
- プロになるためのWeb技術入門　30ページ分読む
### 希望ノルマ
- 同上
- リクエスト、レスポンス、ステートフル、ステートレスについてブログでまとめる（仮）
## 感じたこと
- 特になし
## 学習時間
- 2h20m
- total 252h45m
